--- a/third_party/perfetto/include/perfetto/tracing/track.h
+++ b/third_party/perfetto/include/perfetto/tracing/track.h
@@ -33,6 +33,7 @@
 #include <stdint.h>
 #include <map>
 #include <mutex>
+#include <optional>
 
 namespace perfetto {
 namespace internal {
--- a/third_party/perfetto/include/perfetto/tracing/internal/track_event_internal.h
+++ b/third_party/perfetto/include/perfetto/tracing/internal/track_event_internal.h
@@ -29,6 +29,7 @@
 #include "protos/perfetto/trace/interned_data/interned_data.pbzero.h"
 #include "protos/perfetto/trace/track_event/track_event.pbzero.h"
 
+#include <optional>
 #include <unordered_map>
 
 namespace perfetto {
